from Core import *
def TestF1():
    print("Test1")

    Node1=GDataNode.CreateGradNode(3.0)
    Node2=GDataNode.CreateGradNode(-2.0)
    Node3=Add()(Node1,Node2)
    Node4=GDataNode.CreateGradNode(-7.0)
    Node5=GDataNode.CreateGradNode(4.0)
    Node6=Add()(Node4,Node5)
    Node7=Add()(Node3,Node6)
    Node8=Mul()(Node7,Node7)
    Node9=Relu()(Node8)
    
    GDataNode.Print()
    print("---------------------Build-----------------------------------------------------------")
    PrintDataNode(Node1)
    PrintDataNode(Node2)
    PrintDataNode(Node3)
    PrintDataNode(Node4)
    PrintDataNode(Node5)
    PrintDataNode(Node6)
    PrintDataNode(Node7)
    PrintDataNode(Node8)
    PrintDataNode(Node9)
    print("---------------------Forward-----------------------------------------------------------")
    Forward()
    PrintDataNode(Node1)
    PrintDataNode(Node2)
    PrintDataNode(Node3)
    PrintDataNode(Node4)
    PrintDataNode(Node5)
    PrintDataNode(Node6)
    PrintDataNode(Node7)
    PrintDataNode(Node8)
    PrintDataNode(Node9)
    print("--------------------Backward------------------------------------------------------------")
    Backward()
    PrintDataNode(Node1)
    PrintDataNode(Node2)
    PrintDataNode(Node3)
    PrintDataNode(Node4)
    PrintDataNode(Node5)
    PrintDataNode(Node6)
    PrintDataNode(Node7)
    PrintDataNode(Node8)
    PrintDataNode(Node9)
    ToDot("dot/CoreT1.gv")
def TestF2():
    print("Test2")
    Node1=Grad(1.0)
    Node2=Add()(Node1,Node1)
    Node3=Add()(Node2,Node2)
    Node4=Add()(Node3,Node3)
    #GDataNode.Print()
    print("---------------------Build-----------------------------------------------------------")
    PrintDataNode(Node1)
    PrintDataNode(Node2)
    PrintDataNode(Node3)
    PrintDataNode(Node4)
    print("---------------------Forward-----------------------------------------------------------")
    Forward()
    PrintDataNode(Node1)
    PrintDataNode(Node2)
    PrintDataNode(Node3)
    PrintDataNode(Node4)
    print("--------------------Backward------------------------------------------------------------")
    #print(GOperator.Operators)
    Backward()
    print(GOperator.Operators)
    PrintDataNode(Node1)
    PrintDataNode(Node2)
    PrintDataNode(Node3)
    PrintDataNode(Node4)
    GDataNode.Print()
    ToDot("dot/CoreT2.gv")
#TestF1()
TestF2()